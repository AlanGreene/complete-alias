# Copyright (C) 2016 Cyker Way
#
# This program is free software: you can redistribute it and/or modify it under
# the terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
# details.
#
# You should have received a copy of the GNU General Public License along with
# this program.  If not, see <http://www.gnu.org/licenses/>.

_complete_alias () {
    local alias_name="${COMP_WORDS[0]}"
    local alias_namelen="${#alias_name}"
    local alias_array=( $(alias "$alias_name" | sed -r 's/[^=]*=//' | xargs) )
    local alias_arraylen="${#alias_array[@]}"
    local alias_str="${alias_array[*]}"
    local alias_strlen="${#alias_str}"

    # Rewrite current completion context by expanding alias.
    COMP_WORDS=(${alias_array[@]} ${COMP_WORDS[@]:1})
    (( COMP_CWORD+=($alias_arraylen-1) ))
    COMP_LINE="$alias_str""${COMP_LINE:$alias_namelen}"
    (( COMP_POINT+=($alias_strlen-$alias_namelen) ))

    _command_offset 0
}
#complete -F _complete_alias myalias1
#complete -F _complete_alias myalias2
#complete -F _complete_alias myalias3
